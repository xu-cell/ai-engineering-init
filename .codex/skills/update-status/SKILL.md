---
name: update-status
description: |
  当需要增量更新项目状态、同步最近代码变更时自动使用此 Skill。

  触发场景：
  - 完成一个功能或任务后更新状态
  - 每天开始或结束时同步代码变更
  - 代码审查完成后更新文档
  - 日常维护项目状态

  触发词：更新状态、update-status、状态更新、增量更新、日常同步、更新进度
---

# /update-status - 项目状态智能更新

日常使用的增量更新命令。自动扫描最近的代码变更，智能更新项目文档，保持文档与代码同步。

---

## 🎯 适用场景

| 场景 | 说明 | 频率 |
|------|------|------|
| **功能完成** | 完成一个功能或任务后更新状态 | 实时 |
| **日常同步** | 每天开始或结束时同步代码变更 | 每天1-2次 |
| **代码审查后** | 审查完成后更新文档 | 按需 |
| **周期回顾** | 本周末更新本周的工作成果 | 每周1次 |

---

## 📊 与 /sync 的区别

| 对比项 | `/update-status`（增量）| `/sync`（全量）|
|--------|----------------------|----------------|
| **执行速度** | ⚡ 快速 | 🐢 较慢 |
| **扫描范围** | 最近 N 条提交 | 整个项目 |
| **处理方式** | 增量更新 | 全量重建 |
| **使用频率** | 日常频繁使用 | 每周一次 |

---

## 🚀 执行流程

### 第一步：检查和初始化文档（强制执行）

```bash
# 检查文档目录
Glob pattern: "docs/*.md"

# 必要的文档文件
docs/README.md              # 项目简介
docs/PROJECT_STATUS.md      # 项目进度
docs/TODO.md                # 待办清单
```

### 第二步：分析最近的代码变更

```bash
# 获取最近 20 条提交
git log -20 --oneline --format="%h|%s|%aI" --all

# 扫描业务模块变更
Glob pattern: "ruoyi-modules/ruoyi-*/src/main/java/**/controller/*Controller.java"

# 扫描代码中的待办标记
Grep pattern: "TODO:|FIXME:|XXX:" path: ruoyi-modules/ glob: "*.java" output_mode: content -B 1
```

### 第三步：更新项目进度文档

分析功能完整性，更新 PROJECT_STATUS.md：
- 新增已完成功能
- 更新进行中功能的完成度
- 更新统计信息

### 第四步：更新待办清单文档

同步 TODO.md：
- 将完成的功能移到已完成区域
- 添加新发现的 TODO/FIXME

---

## 输出格式

```markdown
# 📝 项目状态更新报告

**更新时间**：YYYY-MM-DD HH:mm
**扫描范围**：最近 20 条 Git 提交

---

## 📂 文档状态

| 文档 | 操作 | 状态 |
|------|------|------|
| PROJECT_STATUS.md | 已更新 | ✅ |
| TODO.md | 已同步 | ✅ |

---

## 📊 本次变更统计

### PROJECT_STATUS.md 更新
- ✅ 新增已完成：X 项
- 🔄 更新进行中：X 项

### TODO.md 联动更新
- ✅ 移至已完成：X 项
- 📋 新增待办：X 项

---

## 💡 下一步建议

### 立即处理
\`/check\`    # 检查代码规范
\`/progress\` # 查看详细进度

### 日常操作
\`/dev 新功能名称\`   # 继续开发新功能
\`/crud 表名\`        # 为表生成代码
\`/add-todo 任务描述\` # 添加新的待办
```

---

## 🔗 相关命令

| 命令 | 用途 | 何时使用 |
|------|------|---------|
| `/update-status` | 增量更新（当前） | 功能完成后立即使用 |
| `/sync` | 全量同步 | 每周一次定期整理 |
| `/progress` | 项目进度分析 | 了解完成情况 |
| `/check` | 代码规范检查 | 代码审查前 |
| `/add-todo` | 添加单个待办 | 临时添加任务 |

---

## 📌 最佳实践

### ✅ 推荐做法

1. **功能完成后立即更新**
   ```bash
   git push
   /update-status
   ```

2. **利用每天的开始或结束**
   - 早晨：`/update-status` 了解最新状态
   - 下午：`/update-status` 汇总今天的工作

3. **每周末进行全量同步**
   ```bash
   /sync
   ```
