# /add-todo - 快速添加待办事项

作为待办事项管理助手，帮我快速添加待办任务。支持自动创建缺失文档、联动项目状态。

---

## 使用方式

```bash
/add-todo 实现用户权限管理
/add-todo 修复登录bug，优先级高
/add-todo 优化接口性能，3天，中等优先级
/add-todo ruoyi-demo 实现测试功能
/add-todo ruoyi-system 修复缓存问题，高，截止1月30号
```

---

## 第一步：智能检测文档状态

### 检查 待办清单.md

如果 `docs/待办清单.md` 不存在：
1. 读取模板 `.claude/templates/待办清单模板.md`
2. 替换时间占位符为当前时间
3. 创建 `docs/待办清单.md`
4. 输出提示：`📝 已自动创建 docs/待办清单.md`

---

## 第二步：解析任务信息

### 从用户输入中提取

| 信息 | 解析方式 | 默认值 |
|------|---------|--------|
| 任务名称 | 必填，主体内容 | - |
| 优先级 | "高"/"中"/"低"，或"紧急"/"重要" | 中 |
| 预计时间 | "X天"/"X周" | 待定 |
| 所属模块 | 模块名前缀如"ruoyi-demo"、"ruoyi-system" | 通用 |
| 截止日期 | "截止XX"或"deadline XX" | 待定 |

### 优先级映射

| 用户输入 | 映射到 |
|---------|--------|
| 高、紧急、urgent、critical、ASAP | 🔥 高优先级 |
| 中、一般、normal、默认 | 📌 中优先级 |
| 低、可延后、optional、nice-to-have | 💡 低优先级 |

### 模块识别

| 用户输入 | 识别结果 |
|---------|---------|
| `ruoyi-demo 测试功能` | 模块: ruoyi-demo |
| `ruoyi-system 用户管理` | 模块: ruoyi-system |
| `后端 权限管理` | 模块: 后端 |
| `权限管理` | 模块: 通用（无前缀） |

---

## 第三步：添加到 待办清单.md

### 读取现有内容
- 读取 `docs/待办清单.md`
- 解析各优先级区域的位置

### 添加任务

根据优先级添加到对应区域：

```markdown
## 🔥 高优先级（紧急重要）
- [ ] [任务名称]
  - 截止日期: YYYY-MM-DD（如果有）
  - 描述: [任务描述]（如果有）
  - 所属模块: ruoyi-xxx（如果识别到）
  - 预计工作量: X天（如果有）
  - 添加时间: YYYY-MM-DD HH:MM

## 📌 中优先级（重要不紧急）
...

## 💡 低优先级（可延后）
...
```

### 更新统计信息
- 更新"待办总数": X 项
- 更新"最后更新": 当前时间

---

## 第四步：联动更新项目状态.md（如果存在）

### 检查 项目状态.md

如果 `docs/项目状态.md` 存在：
1. 读取项目状态文档
2. 将新任务添加到"待办"区域
3. 格式与 待办清单.md 保持一致

### 添加格式

```markdown
## 📋 待办
- [ ] [任务名称]
  - 优先级: 高/中/低
  - 预计工作量: X天
  - 所属模块: ruoyi-xxx
```

---

## 第五步：输出确认信息

```markdown
✅ 已添加待办任务：

📌 **[任务名称]**
- 优先级: 高/中/低
- 预计时间: X天
- 所属模块: ruoyi-xxx（如果有）
- 截止日期: YYYY-MM-DD（如果有）

📁 已更新文件:
- docs/待办清单.md
- docs/项目状态.md（如果存在）

📊 当前待办总数: X 项
```

---

## 批量添加支持

### 多任务添加

用户可以一次添加多个任务：

```bash
/add-todo 实现用户登录；实现用户注册；实现密码重置
```

或分行：

```
/add-todo
1. 实现用户登录，高优先级
2. 实现用户注册，中优先级
3. 实现密码重置，低优先级
```

### 处理方式
- 按分号、换行、数字编号分割
- 依次解析每个任务
- 批量添加并汇总报告

---

## 智能建议

### 添加后提示

添加任务后，根据情况给出建议：

**待办过多时（>15项）**：
```
💡 提示：当前待办已有 18 项，建议：
- 运行 /progress 梳理优先级
- 考虑将低优先级任务归档
```

**高优先级过多时（>5项）**：
```
⚠️ 提示：高优先级任务已有 6 项
建议重新评估优先级，确保"紧急"真正紧急
```

**相似任务检测**：
```
💡 提示：检测到相似待办：
- 已有: "实现用户登录功能"
- 新增: "用户登录"
是否为同一任务？
```

---

## 示例

### 示例 1：简单添加

```
用户: /add-todo 修复通知发送错误

AI: ✅ 已添加待办任务：

📌 **修复通知发送错误**
- 优先级: 中
- 预计时间: 待定
- 添加时间: 2025-12-25 14:30

📁 已更新: docs/待办清单.md
📊 当前待办总数: 8 项
```

### 示例 2：带参数添加

```
用户: /add-todo ruoyi-demo 实现导出功能，高优先级，2天

AI: ✅ 已添加待办任务：

🔥 **实现导出功能**
- 优先级: 高
- 预计时间: 2天
- 所属模块: ruoyi-demo
- 添加时间: 2025-12-25 14:30

📁 已更新:
- docs/待办清单.md
- docs/项目状态.md

📊 当前待办总数: 9 项
```

### 示例 3：自动创建文档

```
用户: /add-todo 开发后端接口文档

AI: 📝 已自动创建 docs/待办清单.md

✅ 已添加待办任务：

📌 **开发后端接口文档**
- 优先级: 中
- 预计时间: 待定
- 添加时间: 2025-12-25 14:30

📁 已更新: docs/待办清单.md
📊 当前待办总数: 1 项
```

---

## 与其他命令的关系

| 命令 | 关系 |
|------|------|
| `/update-status` | 批量同步 待办清单.md，/add-todo 是单个添加 |
| `/init-docs` | 初始化文档（含 待办清单.md），/add-todo 可自动补充创建 |
| `/progress` | 查看进度，包含待办统计 |
| `/sync` | 全量同步，确保数据一致 |
