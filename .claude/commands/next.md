# /next - 下一步建议

作为项目开发顾问，根据当前项目状态，为您建议下一步应该做什么。

## 🎯 执行流程

### 第一步：快速扫描项目状态

```bash
# 查看最近 Git 提交记录
git log -5 --oneline

# 扫描所有业务模块中的 TODO/FIXME
Grep pattern: "TODO:|FIXME:" path: ruoyi-modules/ glob: "*.java" output_mode: content -B 2

# 检查代码规范和问题
Grep pattern: "package com\.ruoyi\.|BeanUtil\.copy" path: ruoyi-modules/ glob: "*.java" output_mode: files_with_matches
```

### 第二步：分析开发阶段

根据代码完整性和功能数量判断：

| 阶段 | 特征 | 功能完成率 |
|------|------|----------|
| 🟢 初期 | 基础框架搭建，功能模块较少 | < 30% |
| 🟡 中期 | 核心功能开发中，模块逐步完善 | 30-70% |
| 🔴 后期 | 功能基本完成，处于优化阶段 | > 70% |

### 第三步：分类问题和建议

- **紧急问题**：安全漏洞、严重 Bug、编译错误
- **重要问题**：功能缺陷、设计问题、规范问题
- **优化建议**：性能优化、代码重构、文档完善

---

## 📊 输出格式

```markdown
# 🎯 下一步建议

**分析时间**：YYYY-MM-DD HH:mm
**分析范围**：全量后端代码

---

## 📌 当前状态

### Git 提交分析
- **最近一次提交**：[commit message] ([commit hash])
- **最近在做**：[根据提交记录推断]
- **提交频率**：[活跃/不活跃]

### 代码状态
- **开发阶段**：🟡 中期（核心功能开发中）
- **代码质量**：良好（无 com.ruoyi 包名问题）
- **规范问题**：3 个接口缺少 @SaCheckPermission 注解

### 代码待办统计
- **TODO 项**：X 个
- **FIXME 项**：X 个
- **编译/运行错误**：无

---

## 🚀 建议优先级

### 🔴 高优先级（必须立即处理）

1. **修复 FIXME 问题**
   - 位置：ruoyi-demo/PaymentService.java:156
   - 问题：退款金额计算错误
   - 原因：影响财务数据准确性
   - 影响：可能导致资金损失
   - 预计耗时：2-4 小时
   - **快速修复**：`/check` 找出所有 FIXME 并逐一解决

2. **补充缺失的权限注解**
   - 位置：ruoyi-demo 模块 3 个接口
   - 问题：缺少 @SaCheckPermission 注解
   - 原因：权限控制不完整
   - 影响：系统存在权限漏洞
   - 预计耗时：1 小时
   - **快速修复**：`/check demo` 查出所有问题接口

3. **完善代码规范**
   - 问题：部分 BO 缺少 @AutoMapper 注解
   - 原因：对象转换规范不一致
   - 影响：后续维护成本高
   - 预计耗时：2 小时
   - **快速修复**：`/check business` 全量检查

### 🟡 中优先级（近期应该做）

1. **补充缺失功能模块**
   - 建议模块：[根据扫描结果列出未完成的业务模块]
   - 完成率：目前 X%，建议提升到 80%
   - 优势：快速完成核心功能
   - 预计耗时：1-2 天
   - **快速开发**：`/crud [表名]` 快速生成 CRUD 代码

2. **优化 Service 查询层**
   - 建议模块：[根据扫描结果列出查询不完善的模块]
   - 问题：buildQueryWrapper 需要完善
   - 价值：提升查询效率，支持更复杂的搜索
   - 预计耗时：1-2 小时
   - **参考代码**：ruoyi-modules/ruoyi-system/.../service/impl/SysNoticeServiceImpl.java

3. **补充接口文档注释**
   - 建议范围：所有 Controller 接口
   - 目标：添加 @SaCheckPermission 权限注解、JavaDoc 方法注释
   - 价值：便于权限管理和代码可读性
   - 预计耗时：2-3 小时

### 🟢 低优先级（可以考虑）

1. **性能优化**
   - 建议项：添加查询缓存、分页优化
   - 触发条件：数据量大时
   - 预计耗时：2-4 小时

2. **代码重构**
   - 建议项：提取通用工具类、统一错误处理
   - 触发条件：相似代码过多时
   - 预计耗时：1-2 天

3. **单元测试**
   - 建议项：为核心 Service 添加单元测试
   - 触发条件：功能稳定后
   - 预计耗时：1-2 天

---

## 💡 具体行动建议

### 如果您想继续开发新功能：

**推荐 1：完善业务模块**
- 建议实现：[根据扫描结果列出未完成的功能]
- 所属模块：[对应业务模块名]
- 完成率：目前 X%，建议提升到 100%
- 理由：
  - 核心业务模块影响系统的完整性
  - 存在 FIXME/TODO 需优先处理
  - 完成后可以进行集成测试
- **快速开始**：
  ```bash
  /crud [表名]          # 快速生成 CRUD 代码
  /check [模块名]       # 检查并修复规范问题
  ```

**推荐 2：开发新的 demo 模块**
- 建议实现：高级查询、批量操作、数据导入等功能
- 所属模块：ruoyi-demo
- 理由：
  - 可以验证系统新的特性
  - 为其他模块提供参考实现
- **快速开始**：
  ```bash
  /dev 批量操作功能   # 使用向导开发新功能
  ```

### 如果您想优化代码质量：

**推荐 1：规范检查和修复**
- 建议优化：修复所有代码规范问题
- 位置：ruoyi-modules/
- 理由：
  - 提升代码一致性
  - 便于后续维护
  - 防止引入 Bug
- **快速检查**：
  ```bash
  /check               # 全量检查
  /check business      # 按模块检查
  ```

**推荐 2：Service 层优化**
- 建议优化：完善 buildQueryWrapper 实现，支持更复杂的查询
- 位置：[根据扫描结果列出需优化的 ServiceImpl]
- 理由：
  - 当前查询功能不完整
  - 优化后支持高级搜索需求
  - 提升用户体验
- **参考代码**：ruoyi-modules/ruoyi-system/.../service/impl/SysNoticeServiceImpl.java

**推荐 3：注释和文档**
- 建议优化：添加 JavaDoc 注释
- 位置：所有 Controller 接口
- 理由：
  - 提升代码可读性
  - 有助于团队协作

### 如果您想修复现存问题：

**按严重程度排序的问题列表**：

#### 🔴 严重问题（立即修复）
- **FIXME 问题**：[根据扫描结果列出 FIXME 位置和内容]
- **权限注解缺失**：[根据扫描结果列出缺少 @SaCheckPermission 的接口]
- **命令**：`/check [模块名]`

#### 🟡 重要问题（本周修复）
- **BO 映射注解不完整**：[根据扫描结果列出缺少 @AutoMapper 的 BO]
- **Service 查询条件不完整**：[根据扫描结果列出需完善 buildQueryWrapper 的模块]
- **命令**：`/check [模块名]`

#### 🟢 建议问题（择机修复）
- **缺少接口文档**：所有 Controller
- **缺少业务注释**：部分 Service 方法
- **命令**：逐一完善

---

## 🎓 开发建议

### 开发流程建议

1. **明确需求**：使用 `/start` 快速了解项目结构
2. **检查规范**：使用 `/check` 检查代码质量
3. **分析进度**：使用 `/progress` 了解完成情况
4. **开始开发**：使用 `/dev` 或 `/crud` 快速生成代码
5. **添加待办**：使用 `/add-todo` 跟踪任务
6. **获取建议**：使用 `/next` 确定下一步方向

### 最佳实践

| 实践 | 说明 |
|------|------|
| 单一职责 | Service 层负责业务逻辑，Controller 层负责请求处理 |
| 查询优化 | 使用 buildQueryWrapper 规范构建复杂查询条件 |
| 对象转换 | 使用 MapstructUtils，禁止 BeanUtil |
| 权限管理 | 所有公开接口必须有 @SaCheckPermission 注解 |
| 注释完整 | 关键方法必须有 JavaDoc 注释 |
| 定期检查 | 每周至少一次运行 `/check` 和 `/progress` |

### 技术选型建议

| 场景 | 推荐方案 | 理由 |
|------|--------|------|
| 快速生成 CRUD | `/crud` 命令 | 已有表结构时最快 |
| 从零开发功能 | `/dev` 命令 | 包含数据库设计和代码生成 |
| 代码规范检查 | `/check` 命令 | 及时发现问题 |
| 项目进度追踪 | `/progress` 命令 | 定期了解完成情况 |

---

## ❓ 需要确认的问题

### 如果不确定下一步方向，请回答：

- [ ] **您更希望继续开发功能，还是优化现有代码？**
  - 选项 A：继续开发新功能（推荐 `/crud` 或 `/dev` 命令）
  - 选项 B：优化现有代码（推荐 `/check` 和 `/progress` 命令）

- [ ] **您对 Payment 模块中的 FIXME 问题是否有修复计划？**
  - 如需帮助，可使用 `/check demo` 查看详情

- [ ] **是否需要为新开发的功能添加到待办列表中？**
  - 可使用 `/add-todo` 快速添加

---

## 🔗 相关命令

| 命令 | 用途 | 何时使用 |
|------|------|---------|
| `/start` | 快速了解项目 | 初次接触项目 |
| `/check` | 代码规范检查 | 开发完成后、定期检查 |
| `/progress` | 查看项目进度 | 了解完成情况 |
| `/next` | 获取建议 | 不知道下一步做什么 |
| `/dev` | 开发新功能 | 从零开始开发 |
| `/crud` | 快速生成代码 | 表已存在时 |
| `/add-todo` | 添加待办任务 | 跟踪任务 |

---

## 📌 说明

- 本建议基于对当前项目代码的分析生成
- 建议具体且可执行，不空泛
- 会考虑开发的连贯性和代码质量
- 如发现紧急问题会明确标注
- 如不确定用户意图会主动询问
```

